---
title: "Inter-Process Communication - IPC"
tags: 
  - microservices
draft: false
---

IPC - Межпроцессное взаимодействие.

Под этим понимается интеграция различных сервисов друг с другом. Это могут быть различные микросервисы одной системы или связь между различными сервисами (мобильное приложение с погодным сервисом)

|     |     |     |
| --- | --- | --- |
| Взаимодействие \ вид связи | **Один к одному** | **Один ко многим** |
| **Синхронное** | Запрос / ответ |     |
| **Асинхронное** | Асинхронный запрос / ответ<br>Однонаправленное уведомление | Издатель / подписчик<br>Издатель / асинхронные ответы |

- Запрос / ответ - клиент отправляет запрос и блокируется в ожидании ответа
- Асинхронный запрос / ответ - клиент отправляет запрос и не блокируется в ожидании ответа
- Однонаправленное уведомление - клиент отправляет сообщение, не ожидая ничего в ответ
- Издатель / подписчик - клиент публикует сообщение, а его подписчики получают его, не передавая ничего в ответ
- Издатель / асинхронные ответы - клиент публикует сообщение с запросом и какое-то время ожидает ответов от подписчиков

## Виды взаимодействия

- **RPI** (**RPC**) - Remote Procedure Invocation (Call) - удаленный вызов процедур
    - REST
    - gRPC
- Асинхронный обмен сообщениями
    - Брокер сообщений (MQ)
    - ???

## Механизмы коммуникации

### Синхронные

- CORBA - говно мамонта (199x)
- RMI - только для Java приложений
- SOAP - популярный в эпоху серверов приложений (200x)
- Thrift - от Facebook (2007)
- gRPC - от Google (2015)
- [REST](../web/rest.md) - список принципов, противопостовляющих себя RPC, но по сути являющихся им.

### Асинхронные

- AMQP
- STOMP
- WebSockets

## Форматы сообщений

В приложении наши объекты представлены в виде структур данных языка. 
Но для отправки по сети их необходимо преобразовать в такую форму, которую будет легко прочитать на другой стороне.
Процесс преобразования данных в необходимый формат называется сериализацией или маршаллингом. 
Обратный процесс называется десериализацией или анмаршаллингом.

### Текстовые форматы

Текстовые форматы хороши тем, что их может прочитать человек.

Недостатком является то, что приходится передавать много лишней информации, в том числе названия полей.

- [JSON](../formats/json.md) - хорошо читается, позволяет легко изменять. Для определения контракта придумали JSON Schema
- [XML](../formats/xml.md) - строгий. Многословный, сложночитаемый. Для определения контрактов есть XSD-схемы

### Бинарные форматы

Обычно бинарные форматы предоставляют язык описания сообщений, на основе которых затем с помощью утилит, разработанных провайдером формата, генерируется код для выбранной платформы.

Бинарные форматы используется для снижения нагрузки на сеть за счет облегчения сообщений

- Protobuf - используется в gRPC.
- Thrift
- Avro
- Java Serialization - плохой вариант, т.к. не все сервисы могут быть написаны на Java

---
## К изучению

- [ ] Крис Ричардсон "Микросервисы" в части касающейся
- [X] [Видео-курс от Мартина Клеппмана](https://www.youtube.com/watch?v=UEAMfLPZZhE&list=PLeKd45zvjcDFUEv_ohr_HdUFe97RItdiB&ab_channel=MartinKleppmann)