---
title: "Cipher"
tags:
  - security
draft: false
---

# Шифры

Шифр - это обратимое преобразование над данными, выполняемое по определенному алгоритму, предназначенное для сокрытия информации от посторонних лиц. 
Алгоритм, как правило, кастомизируется с помощью секретного параметра, называемого ключом.
Если кто-либо знает тип шифра (алгоритм) и ключ, то он сможет преобразовать зашифрованное сообщение в исходное.

## Устаревшие шифры
### Шифр Цезаря
Шифр Цезаря - это посимвольный сдвиг каждой буквы исходного текста на константное значение.
Например, если ширина сдвига равна 3, то буква `A` преобразуется в `D`, буква `B` в букву `E` и так далее.
Ключом шифра является ширина сдвига.

Т.к. возможное количество ключей ограничено алфавитом, то взломать шифр Цезаря достаточно просто с помощью перебора.

### Зигзагообразный шифр
В зигзагообразном шифре символы исходного текста не меняются, а переставляются согласно определенному правилу.
Например, фраза
```
Who wants to live forever
```

раскладывается зигзагу в несколько рядов
```
W   A   T   V   R   R
 H W N S O I E O E E
  O   T   L   F   V
```

затем цепочки символов, получившиеся в каждом ряде, складываются друг с другом:
```
WATVRRHWNSOIEOEEOTLFV
```

Ключом в зигзагообразном шифре является количество рядов.
Такой шифр тоже можно попробовать взломать перебором количества рядов, хотя это количество может быть уже сколь угодно большим.

### Шифр подстановки
В шифре подстановки каждой букве исходного алфавита ставится в соответствие другая буква алфавита так, чтобы не было дублей.
Похоже на шифр Цезаря, но чуть сложнее.

Для такого шифра подобрать ключ простым перебором уже не получится, т.к. количество различных перестановок для 26 символьного алфавита будет составлять 26!.
Но можно взломать его используя знания о частоте встречающихся символов и каких-либо шаблонов.
Например, в английском языке чаще всего встречается буква `E`, а также в текстах будут достаточно часто встречаться артикли `a` и `the`.
Такой подход к определению ключа шифрования называется **частотным анализом**.

Задачи на решение шифра подставновки иногда даже встречаются в различных книгах / журналах с головоломками.

Шифр Цезаря является частным случаем шифра подстановки.

### Продукционный шифр
Продукционный шифр - это комбинация других шифров.
Например, исходный текст сначала шифруется с помощью шифра подстановки, а затем получившийся результат шифруется с помощью зигзагообразного шифра.

Расшифровка проводится в обратной последовательности.

В идеале продукционный шифр должен сочетать в себе шифры двух видов: подстановки и перемешивания.
При этом каждый тип шифра может применять неоднократно.
А все для того, чтобы при изменении одного символа исходного текста, перестраивался весь зашифрованный текст.

### Шифр Виженера
В шифре Виженера ключом является ограниченная последовательность чисел, где каждое число задает сдвиг для буквы.
Циклически применив этот ключ к исходному тексту, можно его зашифровать.

Например, при ключе 
```
1 0 2 3 1
```

Тест 
```
nothing else matters
```

будет преобразован
```
nothing else matters

1023110 2311 0231102

oovkjog gotf mcwufru
```

Такой шифр гораздо более устойчив к частотному анализу.

Долгое время шифр Виженера считался невзламываемым, но с появлением первых компьютеров, его удалось сломать.

Шифр Цезаря является частным случаем шифра Виженера, где все числа в последовательности одинаковые.

### Шифр Вернама
Если ключ в шифре Виженера имеют такую же длину, как исходный текст, то такой шифр называется шифром Вернама.
Доказано, что если ключ выбран случайным образом и используется только один раз, то взломать такой шифр невозможно.

Если использовать один и тот же ключ для шифрования нескольких текстов, то его можно будет взломать с помощью приема, называемого **crib-dragging**.
Выбирается слово, которое скорее всего должно быть в одном из текстов, это слово называется опорным.
Затем первый текст перебирается с помощью опорного слова, ищется ключ шифра Виженера и с его помощью расшифровывается второй текст. 
Если во втором тексте получилось что-то осмысленное, то ура победа!


## Симметричные шифры

Симметричные шифры - это такие шифры, в которых отправитель и получатель должны обладать одинаковым ключом, чтобы зашифровывать и расшифровывать информацию.

### XOR
XOR - это операция из булевой алгебры:
```
0 xor 0 = 0
0 xor 1 = 1
1 xor 0 = 1
1 xor 1 = 0
```
Применяя операцию XOR к исходному тексту в двоичном представлении против секретного ключа, можно получить зашифрованный текст.
Примени операцию XOR к зашифрованному текста против того же ключа, можно получить исходный текст.

### Потоковый шифр
Потоковые шифры основаны на генераторах псевдослучайных чисел.
Такой генератор на основе секретного ключа может создать бесконечную последовательность псевдослучайных чисел, с помощью которых шифруется исходный текст.

### Блочный шифр
В блочных шифрах исходные данные разбиваются на блоки фиксированного размера, каждый из которых шифруется отдельно.
Если в исходных данных существует некоторый повторяющийся паттерн, то при использовании блочного шифрования без дополнительных ухищрений, этот паттерн будет наблюдаться и в зашифрованных данных.
Чтобы это предотвратить, можно каждый последующий блок перед шифрованием с помощью секретного ключа преобразовывать с помощью результата шифрования предыдущего блока.
Такой прием называется **Cipher Block Chaining**.


---
## К изучению

- [ ] Книга Теоретический минимум по Computer Science, глава 3