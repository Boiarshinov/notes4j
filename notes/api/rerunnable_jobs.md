---
title: "Rerunnable jobs"
tags:
  - api
  - rest
draft: false
---

# Повторяющиеся задачи

Примечание: далее термины "задача" и "джоба" будут использоваться как синонимы.

Один из относительно часто встречающихся паттернов в API - это повторяющиеся задачи.
Это такие задачи, которые необходимо периодически запускать с одинаковыми параметрами.
Такими задачами могут быть, например пайплайны в CI-системе.
Другие примеры применения:
- создание бэкапов
- создание отчетов
- актуализация справочных данных
- очистка ресурсов

Для таких задач может быть полезно разделить на два шага создание шаблона задачи и отдельно ее запуск.
Такой подход может быть удобен для клиентов API, т.к. им не требуется хранить настройки джобы на своей стороне.
Если сделать запуск джобы в один шаг, то клиенту пришлось бы каждый раз передавать все настройки джобы.

Также разделение создания и запуска джобы может быть полезно с точки зрения ограничения прав клиентов API.
Можно выдать права на создание джоб одной группе пользователей, а права на запуск - другой.
Например, создавать пайплайны можно разрешить только девопсам, а запускать их - любым разработчикам.


## Создание джобы

Джобу следует рассматривать как отдельный ресурс.
Для этого ресурса должны быть доступны [стандартные операции](./standard_methods.md):
- создание джобы с переданными параметрами
- запрос списка джоб
- запрос конкретной джобы
- удаление конкретной джобы
- (опционально) обновление конкретной джобы

Стандартные методы должны быть синхронными и выполняться мгновенно.

Метод Update в большинстве случаев лучше не делать, т.к. обновление ресурса может повлиять на уже запущенные джобы.
Лучше проектировать джобы неизменяемыми, а при необходимости обновления удалить старую и создать новую с желаемыми параметрами.


## Запуск джобы
Желательно, чтобы запуск джобы не содержал никаких дополнительных параметров.
Метод запуска джобы оформляется в виде [длительной операции](./long_running_operations.md).


---
## К изучению
- [X] Книга "Паттерны проектирования API". Глава 11
