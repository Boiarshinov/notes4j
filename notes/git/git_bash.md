---
title: "Git Bash"
tags:
  - git
draft: false
---

# Git Bash

## Основные команды:

- `git commit` - делает коммит всех файлов, добавленных в индекс
    - `-a` - для всех файлов
    - `-m <"Message">` - прикрепляет к коммиту указанное сообщение. Сообщения пишут в настоящем времени (по конвенкции)
    - `--ammend` - изменение последнего коммита, если он не был запушен
    - `<file>` - коммитятся изменения только в данном файле

* * *

## Команды для работы с состоянием файлов:

- `git status` - выводит информацию об отслеживаемых файлах
    - `-s` - сокращенный вывод, в котором содержится кроме имени файла еще 2 столбца. Левый - статус файла, правый - модифицирован ли файл.
        - `??` - неотслеживаемый файл
        - `A` - отслеживаемые файлы
        - `M` - файл отредактирован
        - `D` - файл удален
        - `R` - файл переименован
- `git add <fileName> <fileName2> ...` - индексирует файлы в состояние staged
    - `-n (--dry-run)` - файлы не будут добавлены, будет только показана информация о них
    - `-f (--force)` - разрешает добавление игнорируемых файлов
- `git rm <fileName>` - удаляет файл из индекса (при указании регулярным выражением, удаляет из индекса даже те файлы, которые не изменялись)
    - `-f (--force)` - принудительное удаление
    - `-n (--dry-run)` - файлы не удаляются, по ним выводится информация
    - `-r` - рекурсивное удаление директории
    - `-- cached` - удаляет файлы только из индекса
- `git reset <filename>` - удаляет файл из индекса

Если мы хотим, чтобы какие-то файлы не отображались в списке, их можно добавить в файл с именем ".gitignore". В том числе это можно сделать с помощью упрощенных регулярных выражений (glob шаблонов).

* * *

## Команды для работы с ветками

- `git branch` - показывает все ветки. Звездой будет помечена та ветка, в которой мы сейчас находимся.
    - `-a (--all)` - показывает все ветки, которые у нас есть: локальные и удаленные
    - `-r (--remote)` - показывает ветки, находящиеся на удаленном сервере
    - `-list` - показывает ветки, находящиеся на локальном сервере
- `git branch <branchName>` - создает новую ветку от текущего коммита
    - `-f <branchName> <commit>` - перемещает ветку на указанный коммит
```sh
git branch -f master HEAD~3
```
- `git checkout`
    - `<branchName>` - перемещает фокус на указанную ветку
        - `^` - на родителя текущего коммита этой ветки
```sh
git checkout bugFix^
```
        - `~<n>` - на n-ого родителя этой ветки
```sh
git checkout bugFix~4
```
        - `-b <branchName>` - создает новую ветку и перемещает в нее фокус внимания
    - `<commitHash>` - перемещает фокус на указанный коммит
    - `-- <fileName>` - убирает указанный файл из индекса
- `git merge <branchName>` - сливает указанную ветку в ту, на которой находится фокус
- `git rebase <branchname>` - перемещает текущий коммит в вершину указанной ветки

---
## Команды для получения справки

- `git log` - выводит историю коммитов: ветку, автора, дату, сообщение
    - `-p` - выводит подробную информацию об изменениях
    - `--pretty=<preset>`
        - `oneline` - в одну строку
        - `short` - короткий
        - `full` - полный
        - `fuller` - сверхполный
        - `format:"<форматирование вроде printf()>"` - задает формат вывода истории коммитов
            - `%h` - хэш коммита
            - `%an` - имя автора
            - `%ar` - относительная дата
            - `%s` - сообщение коммита

---
## Команды для перехода между коммитами

- `git stash` - сохраняет текущее состояние репозитория без создания коммита. Используется, когда нужно переключиться на другую ветку, но не хочется коммитить последние изменения
    - `list` - посмотреть что находится в стеше. Выводит вместе с индексами, которые можно использовать в командах ниже
    - `pop <n>` - возвращает сохраненные изменения с указанным индексом
    - `apply <n>` - аналог предыдущего, но изменения в том числе остаются в стеше
    - `drop <n>` - сбрасывает сохраненные изменения с указанным индексом из стеша
- `git reset` - откатывает изменения
    - `--soft` - перемещает HEAD на ..., но ни индекс, ни рабочий каталог при этом не изменяются
```sh
git reset --soft HEAD~ //Переместились на предыдущий коммит, индекс сохранился
```
    - `--mixed` - флаг по умолчанию -
```sh
git reset --mixed HEAD~ //Переместились на предыдущий коммит, изменения не включены в коммит
```
    - `--hard` - откатывается к указанному коммиту, не сохраняя изменений
```sh
git reset --hard HEAD~ //Переместились на предыдущий коммит, все изменения откачены до состояния предыдущего коммита
```
- `git revert` - создает новый коммит в вершине дерева, содержащий откаченные изменения
  

---
## Взаимодействие с удаленным репозиторием

- `git fetch` - скачивает объекты и ссылки с удаленного репозитория
    - `-all` - скачивает все
    - `-t (--tags)` - скачивает все теги (метки)
```sh
git fetch origin //Обновляет состояние всех веток в соответствии с репозиторием origin
```

- `git pull [options] [<repository> [<refspec>]`- скачивает и синхронизируется с удаленным репозиторием или веткой
    - Опции:
        - `--no-edit` - принять автоматически сгенерированное сообщение
        - `--no-tags` -
    - `<repository>` - URL репозитория с которым нужно синхронизироваться
    - `<refspec>` - определяет какие ссылки загружать, а какие обновлять
- git push - отправляет наши коммиты на удаленный сервер
    - `<repository>` - URL того репозитория, куда отправляются коммиты
    - `<refspec>` - указывает какую ссылку необходимо обновить в соответствии с каким объектом
    - `--all` - загрузить все ветки
    - `--delete` - удалить все перечисленные ссылки с удаленного репозитория
    - `-f (--force)` - обновляет ссылку с помощью грубой силы

---
## Проверка различия файлов

- `git diff` - сравнивает рабочую директорию с предыдущим коммитом
    - `--cached` - сравнивает текущий индекс с предыдущим коммитом
    - `<branch>` - сравнение с веткой
    - `<commit1> <commit2>` - сравнивает между собой два коммита
    - `<branch1> <branch2>` - сравнение между собой двух веток
    - `--diff-filter=MRC` - показывает только изменения, связанные с изменением, переименованием и копированием, но не с добавлением или удалением файлов
