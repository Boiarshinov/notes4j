---
title: "AOP"
tags:
draft: false
---

**AOP** - Aspect Oriented Programming - Аспектно-ориентированное программирование

В Java приложениях AOP реализуется с помощью установки аннотаций над различными частями кода (классами, методами и т.п.).

Преимуществом AOP является переиспользование кода, упрощение кода бизнес-логики за счет вынесения вспомогательной логики в аспекты. Недостатком является сложность отслеживания потока управления программы (похоже на go-to).

В Java существует две наиболее популярные библиотеки для AOP:

- Spring AOP - поддерживает аспекты только на уровне методов, только runtime-связывание, может применяться только к Spring бинам
- [AspectJ](../external_lib/aspectj.md) - полная поддержка AOP, все виды связывания

Рекомендуется в проектах, разрабатываемых на фреймворке Spring, использовать Spring AOP везде, где существует возможность. Там где невозможно сделать что-либо с его помощью, переходить на AspectJ.

AOP чаще всего используется для следующих целей:
- Логирование
- Открытие и закрытие транзакций
- Проверка доступов
- Кэширование
- Обработка исключений
- Аудит
- Мониторинг и сбор информации об использовании API

### Терминология

- **Aspect** - переиспользуемый кусок кода
- **Advice** - указание действия, которое необходимо выполнить, и условий его вызова
- **Join Point** - когда выполнять код при исполнении приложения
- **Pointcut** - предикат, устанавливающий в каких случаях исполняется действие

### Связывание

Аспекты могут быть привязаны к исполняемым методам различными способами:

- Compile time - при компиляции классов. При компиляции требуется дополнительный шаг для связывания
- Load time - при загрузке классов
- Runtime - во время исполнения приложения

Runtime несет наибольший оверхед, но некоторые действия невозможно выполнить иначе.

Runtime связывание осуществляется с помощью паттерна [Dinamic Proxy](../patterns/dynamic_proxy.md).

### Типы Advice

- Before Advice - действие выполняется перед заходом в метод
- After Finally Advice - действие выполняется после выхода из метода даже при выбрасывании исключения
- After Returning Advice - действие выполняется после выхода из метода, если он успешно отработал
- After Throwing Advice - действие выполняется, если метод выбросил исключение
- Around Advice - действие выполняет перед входом и после выхода из метода

---
## К изучению
- [X] Курс по Spring и Hibernate на Udemy (в части касающейся): https://www.udemy.com/course/spring-hibernate-tutorial
- [ ] Книга AspectJ in action