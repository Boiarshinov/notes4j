---
title: "HTTP"
tags:
  - protocol
draft: false
---

**HTTP** - Hyper Text Transfer Protocol - протокол передачи гипертекста.

Первоначально при разработке протокола планировалось, что по нему будет передаваться только гипертекст в формате HTML, но в настоящее время он используется для передачи любых данных.

Передача данных в HTTP основана на модели клиент-сервер.

Клиент отправляет на сервер запрос - request, а обратно возвращается ответ - response.

Основные элементы реквеста:

- метод HTTP
- URL
- параметры

Основные элементы респонса:

- статус выполнения запроса
- заголовки
- тело сообщения

В случае, если в ответ на запрос вернулся HTML документ, в котором содержатся ссылки на какие-то документы, необходимые для отображения страницы, например, .css или картинки, то браузер самостоятельно направит еще несколько get запросов, чтобы подтянуть недостающие данные.

---
## Структура протокола

Каждое сообщение протокола HTTP состоит из 3 частей:

- Стартовая строка - определяет тип сообщения (метод)
- Заголовки - характеризуют тело сообщения, параметры передачи и др.
- Тело сообщения - данные сообщения. Отделяются от заголовков пустой строкой

---
## Методы HTTP:

- GET - получить. Одинаковые get-запросы должны возвращать одинаковые ответы
```
GET /path/resource?param1=value1&param2=value2 HTTP/1.1
```

- PUT - заменить ресурс.
- POST - создать ресурс. Иногда используется для изменения, удаления или для сложного поиска.
- DELETE - удалить ресурс.
- PATCH - изменить свойство ресурса. В теле запроса отправляется только идентификатор ресурса и изменяемые свойства.
- OPTIONS - сервер возвращает список допустимых методов
- HEAD - аналог GET, но без тела. Используется для извлечения метаданных
- TRACE - запрашивает источник request-а, для того чтобы клиент мог отследить что происходит на другом конце. Используется для тестирования и исправления ошибок.
- CONNECT -
- RETURN -

Для реализации CRUD достаточно всего 2 методов: GET и POST

---
## Заголовки:

- content-type - содержит информацию в каком виде представлен ответ сервера. Может быть HTML, XML, JSON или что-нибудь еще. Тип контента записывается с помощью [MIME](../web/mime.md)-типов. Виды MIME-типов можно найти тут:  https://ru.wikipedia.org/wiki/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_MIME-%D1%82%D0%B8%D0%BF%D0%BE%D0%B2
- User-Agent - информация о клиенте, с которого был отправлен HTTP-запрос. Обычно здесь написана версия браузера. Веб-приложения обычно используют данные из этого заголовка, чтобы подстроить верстку под указанный браузер.
- [Cookie](../web/cookie.md) - информация, которая хранится в браузере и обычно используется для идентификации пользователя. Чаще всего используется для обеспечения сессий.
- status - содержит код статуса выполнения запроса, который обозначается тремя цифрами. См. ниже
- date

---
## Статусы

В стартовой строке ответа сервера содержится код состояния - целое число из 3 цифр:

- 1хх - информационный
- 2хх - успех. Пример: 200  - все хорошо
- 3хх - перенаправление (Редирект)
- 4хх - ошибка клиента. Пример: 404 - страница не найдена
- 5хх - ошибка сервера.

![](../../images/http_response_codes.jpg)

Полный перечень ошибок:  https://en.wikipedia.org/wiki/List_of_HTTP_status_codes

---
## HTTP клиенты

В Java для отправки запросов по HTTP-протоколу используются различные механизмы. Часть из них относится к стандартным средствам языка, а часть является сторонними библиотеками:

- пакет `java.net`, существующий в Java с версии 1.1 с его классами `HttpURLConnection` и пр.
- HTTP API, появившийся в Java 9;
- [Apache Http Client](../external_lib/apache_http_client.md) - дедушка всех http-клиентов.
- Unirest Http API - надстройка над Apache Http Client с упрощенным API
- OkHttp
- Spring RestTemplates

---
## К изучению:

- [X] Просто о HTTP: https://habr.com/ru/post/215117/
- [X] Вики:  https://ru.wikipedia.org/wiki/HTTP
- [X] Пример простого HTTP сервера на Java:  https://habr.com/ru/post/441150/
- [X] Видеоурок по Java EE от Алишева:  https://www.youtube.com/watch?v=V6W-AfjWVaQ&list=PLAma_mKffTOTTFqIkLXgHqVuL6xJhb0mr
- [X] HTTP-клиенты для Java: https://www.reddit.com/r/java/comments/6ixhqe/recommendations_for_java_http_client_libraries/
- [X] Объяснение разницы между PUT, POST и PATCH: https://stackoverflow.com/questions/31089221/what-is-the-difference-between-put-post-and-patch