---
title: "Scheduled - регулярное выполнение задач"
tags:
  - spring
draft: false
---

## Аннотация @Scheduled

Для того чтобы выполнять в приложении какие-то действия с заданной периодичностью в Spring была введена аннотация `@Scheduled`.

Аннотация проставляется над методом. Метод не должен иметь аргументов и должен возвращать void.

```java
@Scheduled(fixedRate = 60_000)
public void scheduledMethod() {
    //...
}
```

В аннотацию должен быть передан один (и только один) из следующих аргументов:

- `cron` - устанавливает периодичность вызова метода с помощью crontabe нотации (см. подробнее в ссылках)
- `fixedDelay` - устанавливает в миллисекундах разницу между окончанием предыдущего вызова метода и началом следующего.
- `fixedRate` - устанавливает периодичность вызова метода в миллисекундах.

Также есть необязательные аргументы:

- `initialDelay` - задержка перед первым вызовом метода после запуска приложения.
- `zone` - таймзона для крон тасок. По умолчанию они запускаются в соответствии с тем часовым поясом, который указан в системе.

У всех аргументов, принимающих числовое значение, есть версия, принимающая строку. Например аргументу `fixedRate` соответствует `fixedRateString`.

---
## Крон

Крон позволяет гибко задать периодичность вызова таски.

Крон-таски - это стандартные периодические таски в UNIX-системах. При написании крон-тасок в Spring синтаксис с помощью которого настраивается периодичность таски отличается от стандартной

```
* * * * * ?
| | | | | |_ день недели
| | | | |___ месяц (0-11)
| | | |_____ дни (0-31)
| | |_______ часы (0-23)
| |_________ минуты (0-59)
|___________ секунды (0-59)
```

`*` означает каждый

`0 10 15 12 * ?` - означает, что таска будет выполняться в 15:10 каждый месяц 12 числа.

По умолчанию крон-таски будут выполняться по часовому поясу системы. Чтобы установить необходимое смещение, необходимо в аннотации определить параметр `zone`.

Значения крона обычно выносятся в properties-файл для возможности изменения периодичности выполнения тасок без привлечения программиста.

---
## Подключение планировщика к проекту

Для того чтобы аннотации `@Scheduled` заработали, необходимо проставить над конфигурационным классом приложения аннотацию `@EnableScheduling`:

```java
@SpringBootApplication
@EnableScheduling
public class AppConfig {
    //...
}
```

---
## К изучению:

- [X] Javadoc на аннотацию
- [X] Baeldung: https://www.baeldung.com/spring-scheduled-tasks