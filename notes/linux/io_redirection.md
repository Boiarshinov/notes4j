---
title: "Input-Output redirection"
tags:
  - linux
  - io
draft: false
---

# Input-Output redirection

В Linux существует три стандартных потока ввода-вывода:
- __stdin__ - входной поток. По умолчанию получает ввод с клавиатуры
- __stdout__ - выходной поток. По умолчанию поток выводится в терминал
- __stderr__ - выходной поток ошибок. По умолчанию поток выводится в терминал

Потокам соответствуют файловые дескрипторы с жестко заданными номерами: stdin - 0, stdout - 1, stderr - 2.

Потоки можно перенаправить со стандартных мест в пользовательские.
Например, можно перенаправить вывод команды в файл, вместо терминала.

Для перенаправления потока ввода используется символ `<`:
```bash
Mail -s "Subject" to-address < Filename
```

Гораздо чаще может пригодиться перенаправление потока вывода.
Вывод можно перенаправлять в файл, в сокет, на устройство (в Linux всё файл!).
У перенаправления есть два режима: 
- `>` направляет поток в файл. Если файл уже существовал, то предыдущая версия стирается и вывод записывается на чистую
- `>>` направляет поток в файл, записывая вывод в конец файла, если он уже существовал

Вот так можно перенаправить вывод команды в файл:
```bash
curl -v host:port/path > request.log
```

Перенаправлять вывод можно не только в файл, но и на устройства:
```bash
cat song.mp3 > /dev/audio
```

Достаточно часто поток перенаправляют в специальное эфемерное устройство `/dev/null`. Это все равно что проигнорировать поток.
```bash
command > /dev/null
```

Поток ошибок можно перенаправить с помощью символов `2>`.
Здесь `2` - это номер файлового дескриптора.
```bash
command 2> errorfile
```
Обычно это делают, чтобы разделить вывод на ошибки и полезный вывод.
В этом случае их удобнее анализировать.
Так, например, обычно разделяются логи [nginx](../devops/nginx.md).


## Pipe
Вывод одной команды можно перенаправить на вход другой команде с помощью специального оператора `|`, называемого __pipe__.
```bash
cat file1 | grep substring | head -n 2
```

Такая команда перенаправит вывод `cat` в поисковый движок `grep`, а все найденные вхождения оттуда будут перенаправлены в `head`, который выведет первые две строчки.

---
## К изучению
- [X] Статья про [IO redirection](https://www.linuxjournal.com/content/everything-you-need-know-about-linux-input-output-redirection)
