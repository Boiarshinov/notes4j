---
title: "NoSQL"
tags:
  - database
  - nosql
draft: false
---

# NoSQL

Расшифровывается как Not only SQL

Причины возникновения:
- Плохая масштабируемость реляционных БД
- Малая скорость работы с данными реляционных БД, связанная с их универсальностью
- Многие модели данных проще смоделировать другими инструментами, а не реляционными

Особенности NoSQL:
- Более сложная структура, чем реляционные таблички
- нет строго определенной схемы
- нет операций соединения JOIN
- Масштабируется
- не используется SQL

## CAP теорема
**CAP-теорема**: можно выбрать только две характеристики из трех:
- Consistency - согласованность данных на разных узлах (серверах)
- Availability - способность системы отвечать на все запросы пользователей
- Partition tolerance - возможность разрыва связи между несколькими узлами (серверами)

<mark>Вынести в отдельную заметку</mark>

Реляционные БД выбирают Consistency и Availability, пренебрегая тем, что при отказе одного сервера падает вся система. Большая часть NoSQL БД выбирают Consistency и Partition tolerance, при этом если один узел отвалится, то он не будет отвечать

## BASE-архитектура

- Basically Available - сбой узла приводит к отказу только для части пользователей
- Soft-state - система может находится в неустойчивом состоянии, но должна стремиться выбраться из него
- Eventual Consistency - в произвольный момент времени данные на разных узлах могут быть несогласованы, но система должна стараться согласовать данные по всем узлам.

## Типы NoSQL СУБД

|     |     |     |
| --- | --- | --- |
| **Тип NoSQL СУБД** | **Область применения** | **Представители** |
| Ключ-значение | - Работа с данными в реальном времени (чаты, игры)<br>- Кэширование результатов долгих операций<br>- Файловые системы на основе ключ-значение | - Berkeley DB<br>- Redis<br>- Memcache |
| Документоориентированные | - Хранение документов и поиск по ним<br>- Информационные сервисы<br>- Данные с нечеткой схемой | - MongoDB<br>- CouchDB |
| Семейство столбцов | - Хранение данных, собранных с веб-страниц<br>- Хранение и поиск по большому объему данных | - Cassandra<br>- HBase<br>- BigTable (Google) |

## Представители NoSQL

### Redis
Чемпион по скорости доступа к данным, т.к. вся БД хранится в оперативной памяти.

Информацию можно получить только по ключу.
Типы данных:

- Строки (в них может содержаться числа)
- Хэши
- Списки - аналог `List<>`
- Множества - аналог `Set<>`
- Упорядоченные множества - аналог `TreeSet<>`

В Redis поддерживается репликация.
В Redis есть механизм подписки пользователя на обновления сервера.

### MongoDB
Самая популярная документоориентированная СУБД
Сложно воспринимаются запросы.

Запросы пишутся на JavaScript с использованием убогого синтаксиса, но можно найти драйвер, который позволит писать на твоем любимом ЯП.

Вместо JOIN можно использовать:

- Ссылки на объекты
- Встроенные документы (может привести к аномалиям)
- DBRef - применяется в драйверах и ORM